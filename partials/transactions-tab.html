<!-- Credentials Setup Section -->
<div class="transactions-section">
    <div class="section-title-trans">âš™ï¸ Max Configuration</div>
    <div class="alert-trans alert-info-trans" id="credentialsAlert">
        Configure your Max credentials to start syncing transactions.
    </div>
    <button class="btn btn-primary" onclick="openCredentialsModal()">
        ğŸ” Setup Max Credentials
    </button>
</div>

<!-- Sync Section -->
<div class="transactions-section">
    <div class="section-title-trans">ğŸ”„ Sync Transactions</div>
    <div class="sync-status">
        <div class="sync-info">
            <div>Last sync: <strong id="lastSyncTime">Never</strong></div>
            <div id="lastSyncCount"></div>
        </div>
        <div class="sync-buttons">
            <button class="btn btn-primary" onclick="syncTransactions()" id="syncBtn">
                ğŸ”„ Sync Now
            </button>
            <button class="btn btn-success" onclick="autoLabelAll()" id="autoLabelBtn">
                ğŸ·ï¸ Auto-label
            </button>
        </div>
    </div>
    
    <div class="loading-trans" id="syncLoading">
        <div class="spinner-trans"></div>
        <div>Syncing with Max...</div>
    </div>

    <div id="syncResult"></div>
</div>

<!-- Filters Section -->
<div class="transactions-section" id="filtersSection" style="display: none;">
    <div class="section-title-trans">ğŸ” Filters</div>
    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
        <!-- Unlabeled checkbox -->
        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
            <input type="checkbox" id="showOnlyUnlabeled" onchange="applyFilters()" style="width: 18px; height: 18px; cursor: pointer;">
            <span>Show only unlabeled</span>
        </label>
        
        <!-- Month filter -->
        <select id="monthFilter" onchange="applyFilters()" style="padding: 8px 12px; border: 2px solid #dee2e6; border-radius: 8px; font-size: 0.9em; cursor: pointer;">
            <option value="">All months</option>
        </select>
        
        <!-- NEW: Category filter -->
        <select id="categoryFilter" onchange="applyFilters()" style="padding: 8px 12px; border: 2px solid #dee2e6; border-radius: 8px; font-size: 0.9em; cursor: pointer;">
            <option value="">All categories</option>
        </select>
        
        <!-- NEW: Search by name -->
        <input 
            type="text" 
            id="searchFilter" 
            placeholder="Search transactions..." 
            oninput="applyFilters()"
            style="padding: 8px 12px; border: 2px solid #dee2e6; border-radius: 8px; font-size: 0.9em; flex: 1; min-width: 200px;"
        />
        
        <button class="btn btn-secondary" onclick="clearFilters()" style="padding: 8px 16px; background: #e9ecef; border: none; border-radius: 8px; cursor: pointer; font-size: 0.9em;">
            Clear filters
        </button>
    </div>
</div>

<!-- All Transactions -->
<div class="transactions-section" id="allTransactionsSection" style="display: none;">
    <div class="section-title-trans">
        ğŸ“‹ All Transactions (<span id="transactionCount">0</span>)
    </div>
    <div id="allTransactionsList"></div>
</div>

<div class="empty-state-trans" id="emptyState">
    <div class="spinner-trans"></div>
    <div>Loading transactions...</div>
</div>

<!-- Credentials Modal -->
<div id="credentialsModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>ğŸ” Max Credentials</h2>
            <button class="modal-close" onclick="closeCredentialsModal()">âœ•</button>
        </div>
        <div class="modal-body">
            <div class="alert-trans alert-info-trans">
                Your credentials will be encrypted and stored securely in Firebase.
            </div>
            <form id="credentialsForm" onsubmit="saveCredentials(event)">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 500;">Max Username</label>
                    <input 
                        type="text" 
                        class="auth-input" 
                        id="maxUsername" 
                        placeholder="Your Max username"
                        required
                    />
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 500;">Max Password</label>
                    <input 
                        type="password" 
                        class="auth-input" 
                        id="maxPassword" 
                        placeholder="Your Max password"
                        required
                    />
                </div>
                <div id="credentialsError"></div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="modal-button secondary" onclick="closeCredentialsModal()">
                Cancel
            </button>
            <button type="submit" form="credentialsForm" class="modal-button primary" id="saveCredentialsBtn">
                Save Credentials
            </button>
        </div>
    </div>
</div>
